import React, { useCallback, useRef, useState } from 'react';

import { useOnClickOutside } from '../../../../hooks/useOnClickOutside';

import s from './RecommendationsMenu.module.scss';
import Link from 'next/link';

export const RecommendationsMenu = () => {
  const menuRef = useRef(null);
  const [open, setOpen] = useState(false);

  const handleClickOutside = useCallback(() => {
    setOpen(false);
  }, []);

  useOnClickOutside([menuRef], handleClickOutside);

  return (
    <div className={s.root}>
      <button className={s.trigger} onClick={() => setOpen(true)}>
        <RecommendationsIcon /> Recommendations <ChevronDownIcon />
      </button>
      {open && (
        <div className={s.menu} ref={menuRef}>
          <Link href="/recommendations/runs" passHref>
            <a className={s.menuItem}>
              <RunsIcon />
              <span className={s.menuItemLabel}>Runs</span>
              <span className={s.menuItemCount}>2</span>
              <CaretIcon />
            </a>
          </Link>

          <Link href="/recommendations/members" passHref>
            <a className={s.menuItem}>
              <OptinIcon />
              <span className={s.menuItemLabel}>Opted-in</span>
              <span className={s.menuItemCount}>1</span>
              <CaretIcon />
            </a>
          </Link>

          <Link href="/recommendations/history" passHref>
            <a className={s.menuItem}>
              <HistoryIcon />
              <span className={s.menuItemLabel}>History</span>
              <span className={s.menuItemCount}>2</span>
              <CaretIcon />
            </a>
          </Link>
        </div>
      )}
    </div>
  );
};

const RecommendationsIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M14.3959 2.33826C14.4172 2.25894 14.4538 2.18458 14.5038 2.11943C14.5537 2.05427 14.616 1.9996 14.6871 1.95854C14.7582 1.91747 14.8367 1.89082 14.9181 1.8801C14.9995 1.86939 15.0823 1.87481 15.1616 1.89608C16.4038 2.22967 17.4272 2.99842 18.0413 4.06248C18.1241 4.20607 18.1466 4.3767 18.1037 4.53684C18.0607 4.69698 17.9559 4.83351 17.8124 4.91639C17.6688 4.99927 17.4981 5.02171 17.338 4.97878C17.1779 4.93586 17.0413 4.83107 16.9584 4.68748C16.5116 3.91248 15.7584 3.34998 14.8381 3.10389C14.7588 3.08267 14.6845 3.04604 14.6193 2.99607C14.5541 2.94611 14.4995 2.88379 14.4584 2.81269C14.4173 2.74159 14.3907 2.6631 14.38 2.58169C14.3693 2.50029 14.3747 2.41757 14.3959 2.33826ZM6.21704 17.6344C5.48423 17.0562 4.87173 16.3187 4.29126 15.3125C4.25022 15.2414 4.19558 15.1791 4.13046 15.1291C4.06534 15.0791 3.99101 15.0424 3.91171 15.0212C3.83242 14.9999 3.74972 14.9945 3.66833 15.0052C3.58694 15.0159 3.50845 15.0425 3.43735 15.0836C3.36625 15.1246 3.30394 15.1793 3.25395 15.2444C3.20397 15.3095 3.16731 15.3838 3.14605 15.4631C3.12479 15.5424 3.11936 15.6251 3.13007 15.7065C3.14078 15.7879 3.16741 15.8664 3.20845 15.9375C3.87173 17.0859 4.5811 17.9367 5.44282 18.6156C5.57315 18.7159 5.73774 18.7607 5.90093 18.7405C6.06411 18.7202 6.21274 18.6365 6.31459 18.5074C6.41645 18.3783 6.46332 18.2143 6.44506 18.0508C6.4268 17.8874 6.34488 17.7378 6.21704 17.6344ZM15.3272 4.56404C15.2462 4.41975 15.1374 4.29297 15.0071 4.19105C14.8768 4.08912 14.7275 4.01408 14.568 3.97028C14.4084 3.92649 14.2418 3.91479 14.0777 3.93589C13.9136 3.95699 13.7553 4.01045 13.612 4.09318C13.4687 4.17591 13.3433 4.28627 13.243 4.41784C13.1427 4.54942 13.0695 4.6996 13.0277 4.85967C12.9858 5.01975 12.9762 5.18653 12.9993 5.35036C13.0224 5.51419 13.0779 5.6718 13.1624 5.81404L14.4124 7.97889C14.4534 8.04998 14.4801 8.12847 14.4908 8.20986C14.5015 8.29126 14.4961 8.37397 14.4748 8.45326C14.4535 8.53256 14.4169 8.60689 14.3669 8.67201C14.3169 8.73713 14.2546 8.79177 14.1834 8.83279C13.6093 9.16435 13.1904 9.71037 13.0189 10.3508C12.8473 10.9912 12.9371 11.6735 13.2686 12.2476C13.3515 12.3912 13.3739 12.5619 13.331 12.722C13.2881 12.8821 13.1833 13.0187 13.0397 13.1015C12.8961 13.1844 12.7255 13.2069 12.5653 13.1639C12.4052 13.121 12.2687 13.0162 12.1858 12.8726C11.7437 12.1046 11.5875 11.2049 11.7448 10.3328C11.9021 9.46069 12.3627 8.67228 13.0452 8.10701L9.89282 2.64998C9.72706 2.3628 9.45401 2.15323 9.13373 2.06738C8.81345 1.98152 8.47219 2.02641 8.18501 2.19217C7.89783 2.35793 7.68826 2.63098 7.6024 2.95126C7.51655 3.27154 7.56144 3.6128 7.7272 3.89998L10.2272 8.23045C10.3049 8.37362 10.3237 8.54148 10.2795 8.69828C10.2353 8.85508 10.1316 8.98842 9.99056 9.0699C9.84949 9.15139 9.68218 9.17457 9.52427 9.13451C9.36636 9.09445 9.23034 8.99432 9.14517 8.85545L6.02016 3.44217C5.8544 3.15499 5.58135 2.94542 5.26108 2.85956C4.9408 2.77371 4.59953 2.8186 4.31235 2.98436C4.02517 3.15012 3.8156 3.42317 3.72975 3.74345C3.64389 4.06372 3.68878 4.40499 3.85454 4.69217L7.29204 10.6461C7.33567 10.7172 7.36462 10.7964 7.37716 10.8789C7.3897 10.9614 7.38559 11.0456 7.36507 11.1265C7.34455 11.2074 7.30803 11.2834 7.25767 11.3499C7.20731 11.4165 7.14414 11.4723 7.07187 11.514C6.99959 11.5558 6.91969 11.5826 6.83688 11.593C6.75406 11.6034 6.67001 11.597 6.58968 11.5744C6.50935 11.5517 6.43437 11.5132 6.36916 11.4611C6.30395 11.409 6.24984 11.3444 6.21001 11.2711L4.02251 7.48279C3.94043 7.3406 3.83115 7.21596 3.70091 7.11599C3.57066 7.01603 3.422 6.9427 3.26342 6.90019C3.10483 6.85768 2.93943 6.84682 2.77665 6.86823C2.61386 6.88964 2.45689 6.94291 2.3147 7.02498C2.1725 7.10706 2.04786 7.21634 1.9479 7.34658C1.84793 7.47683 1.7746 7.62549 1.73209 7.78407C1.68958 7.94266 1.67872 8.10806 1.70013 8.27084C1.72154 8.43363 1.77481 8.5906 1.85688 8.73279L5.29438 14.6867C6.20818 16.2616 7.7094 17.4097 9.46867 17.879C11.2279 18.3484 13.1015 18.1007 14.6784 17.1903C16.2553 16.2799 17.4066 14.7812 17.8797 13.0229C18.3529 11.2647 18.1092 9.39051 17.2022 7.8117L15.3272 4.56404Z"
      fill="#3D4A5C"
    />
  </svg>
);

const ChevronDownIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M16.9137 8.1633L10.6637 14.4133C10.5766 14.5007 10.4731 14.57 10.3592 14.6174C10.2452 14.6647 10.1231 14.689 9.99967 14.689C9.87628 14.689 9.75411 14.6647 9.64016 14.6174C9.5262 14.57 9.42271 14.5007 9.33561 14.4133L3.08561 8.1633C2.90949 7.98718 2.81055 7.74831 2.81055 7.49923C2.81055 7.25016 2.90949 7.01129 3.08561 6.83517C3.26173 6.65905 3.5006 6.56011 3.74967 6.56011C3.99874 6.56011 4.23762 6.65905 4.41374 6.83517L10.0005 12.4219L15.5872 6.83439C15.7633 6.65827 16.0022 6.55933 16.2512 6.55933C16.5003 6.55933 16.7392 6.65827 16.9153 6.83439C17.0914 7.01051 17.1904 7.24938 17.1904 7.49845C17.1904 7.74752 17.0914 7.9864 16.9153 8.16252L16.9137 8.1633Z"
      fill="#3D4A5C"
    />
  </svg>
);

const CaretIcon = () => (
  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" className={s.caret}>
    <path
      d="M11.5306 8.5306L6.5306 13.5306C6.3897 13.6715 6.19861 13.7506 5.99935 13.7506C5.80009 13.7506 5.60899 13.6715 5.4681 13.5306C5.3272 13.3897 5.24805 13.1986 5.24805 12.9993C5.24805 12.8001 5.3272 12.609 5.4681 12.4681L9.93747 7.99997L5.46935 3.5306C5.39958 3.46083 5.34424 3.37801 5.30649 3.28686C5.26873 3.19571 5.2493 3.09801 5.2493 2.99935C5.2493 2.90069 5.26873 2.80299 5.30649 2.71184C5.34424 2.62069 5.39958 2.53786 5.46935 2.4681C5.53911 2.39833 5.62194 2.34299 5.71309 2.30524C5.80424 2.26748 5.90194 2.24805 6.0006 2.24805C6.09926 2.24805 6.19696 2.26748 6.28811 2.30524C6.37926 2.34299 6.46208 2.39833 6.53185 2.4681L11.5318 7.4681C11.6017 7.53786 11.6571 7.62072 11.6948 7.71193C11.7326 7.80313 11.7519 7.9009 11.7518 7.99961C11.7517 8.09832 11.7321 8.19604 11.6941 8.28715C11.6562 8.37827 11.6006 8.461 11.5306 8.5306Z"
      fill="#8897AE"
    />
  </svg>
);

const RunsIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M11.8759 7.1875C12.4321 7.1875 12.9759 7.02255 13.4384 6.71351C13.9009 6.40447 14.2614 5.96522 14.4743 5.4513C14.6871 4.93738 14.7428 4.37188 14.6343 3.82631C14.5258 3.28074 14.2579 2.7796 13.8646 2.38626C13.4713 1.99293 12.9701 1.72506 12.4246 1.61654C11.879 1.50802 11.3135 1.56372 10.7996 1.77659C10.2857 1.98946 9.8464 2.34995 9.53736 2.81246C9.22831 3.27497 9.06336 3.81874 9.06336 4.375C9.06336 5.12092 9.35968 5.83629 9.88713 6.36374C10.4146 6.89118 11.1299 7.1875 11.8759 7.1875ZM11.8759 3.4375C12.0613 3.4375 12.2425 3.49248 12.3967 3.5955C12.5509 3.69851 12.671 3.84493 12.742 4.01624C12.813 4.18754 12.8315 4.37604 12.7954 4.5579C12.7592 4.73976 12.6699 4.9068 12.5388 5.03791C12.4077 5.16903 12.2406 5.25831 12.0588 5.29449C11.8769 5.33066 11.6884 5.3121 11.5171 5.24114C11.3458 5.17018 11.1994 5.05002 11.0964 4.89585C10.9933 4.74168 10.9384 4.56042 10.9384 4.375C10.9384 4.12636 11.0371 3.8879 11.213 3.71209C11.3888 3.53627 11.6272 3.4375 11.8759 3.4375ZM17.8134 10.7344C17.8134 10.9139 17.7619 11.0896 17.6649 11.2407C17.568 11.3918 17.4297 11.5119 17.2665 11.5867C16.7276 11.7775 16.1608 11.8773 15.5891 11.882C14.4954 11.882 12.9134 11.5836 10.9196 10.3977C10.6886 10.9616 10.4206 11.5097 10.1173 12.0383C11.9634 12.7211 14.6884 14.3594 14.6884 18.125C14.6884 18.3736 14.5896 18.6121 14.4138 18.7879C14.238 18.9637 13.9995 19.0625 13.7509 19.0625C13.5022 19.0625 13.2638 18.9637 13.088 18.7879C12.9121 18.6121 12.8134 18.3736 12.8134 18.125C12.8134 16.6648 12.2704 15.5422 11.1524 14.6922C10.4368 14.1453 9.62508 13.8328 9.00946 13.65C8.94618 13.7281 8.88133 13.8063 8.81415 13.8805C7.25165 15.6672 5.31258 16.5961 3.16961 16.5961C2.91523 16.5961 2.661 16.5833 2.4079 16.5578C2.2847 16.5464 2.16498 16.5108 2.05564 16.4529C1.94629 16.395 1.84947 16.3161 1.77078 16.2207C1.69208 16.1252 1.63305 16.0151 1.5971 15.8967C1.56115 15.7783 1.54898 15.654 1.5613 15.5309C1.57362 15.4078 1.61018 15.2884 1.66888 15.1795C1.72758 15.0706 1.80726 14.9744 1.90331 14.8964C1.99937 14.8184 2.1099 14.7602 2.22855 14.7252C2.3472 14.6901 2.47161 14.6789 2.59461 14.6922C6.68055 15.1 8.64774 11.1047 9.29696 9.39922C6.62586 8.00469 4.98055 9.27969 4.96258 9.29688C4.76784 9.44317 4.52381 9.50794 4.28215 9.47745C4.04049 9.44696 3.82019 9.32362 3.66788 9.13354C3.51558 8.94347 3.44323 8.70157 3.46615 8.45908C3.48908 8.21659 3.60548 7.99254 3.79071 7.83438C3.91336 7.73438 6.87586 5.425 11.1532 8.32969C14.5204 10.6195 16.4735 9.88594 16.5048 9.87344C16.6473 9.81202 16.8028 9.78692 16.9574 9.80042C17.112 9.81391 17.2608 9.86556 17.3905 9.95074C17.5202 10.0359 17.6267 10.152 17.7005 10.2885C17.7743 10.425 17.8131 10.5776 17.8134 10.7328V10.7344Z"
      fill="#3D4A5C"
    />
  </svg>
);

const OptinIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M9.65853 17.1023C9.60784 17.3052 9.4908 17.4852 9.32603 17.6139C9.16127 17.7426 8.95822 17.8125 8.74916 17.8125C8.67227 17.8123 8.59567 17.8029 8.52103 17.7844L6.02103 17.1594C5.91693 17.134 5.81805 17.0906 5.72885 17.0312L3.85385 15.7812C3.64665 15.6433 3.50275 15.4286 3.45381 15.1845C3.40488 14.9404 3.45491 14.6869 3.59291 14.4797C3.7309 14.2725 3.94556 14.1286 4.18965 14.0797C4.43374 14.0307 4.68727 14.0808 4.89447 14.2188L6.63432 15.3789L8.97806 15.9648C9.21911 16.0255 9.4262 16.1794 9.5538 16.3927C9.6814 16.606 9.71908 16.8613 9.65853 17.1023ZM19.921 9.58984C19.8568 9.78448 19.7548 9.96449 19.6207 10.1195C19.4866 10.2745 19.3232 10.4014 19.1398 10.493L17.3531 11.3867L13.1671 15.6625C13.0526 15.7771 12.9104 15.86 12.7543 15.9033C12.5983 15.9466 12.4336 15.9487 12.2765 15.9094L7.2765 14.6594C7.1592 14.6298 7.04862 14.5781 6.95072 14.507L2.73353 11.4281L0.863221 10.4906C0.679346 10.3992 0.515284 10.2725 0.380416 10.1177C0.245548 9.96287 0.142518 9.78298 0.0772175 9.58831C0.0119165 9.39364 -0.0143751 9.18801 -0.000154175 8.98317C0.0140667 8.77834 0.0685212 8.57831 0.160096 8.39453L2.10853 4.51484C2.29392 4.14431 2.61888 3.86257 3.01196 3.7316C3.40504 3.60062 3.83404 3.63113 4.20463 3.81641L5.81322 4.62188L9.73588 3.475C9.90784 3.425 10.0905 3.425 10.2624 3.475L14.1851 4.62188L15.7968 3.81563C16.1672 3.63139 16.5955 3.60153 16.9878 3.73261C17.3802 3.86368 17.7045 4.14499 17.8898 4.51484L19.8312 8.39688C19.9244 8.57988 19.9803 8.77957 19.9957 8.98435C20.0111 9.18914 19.9858 9.39495 19.921 9.58984ZM15.6476 10.4688L13.6945 6.5625H11.6288L8.64447 9.45703C9.87572 10.0242 11.0788 9.47188 11.8335 8.71094C11.9965 8.54712 12.2142 8.44927 12.4449 8.43614C12.6756 8.42302 12.903 8.49556 13.0835 8.63984L15.5257 10.593L15.6476 10.4688ZM1.98119 8.95547L2.80385 9.36719L4.46556 6.04453L3.64213 5.63281L1.98119 8.95547ZM14.2179 11.9531L12.5226 10.5914C10.9218 11.7859 8.94057 11.9031 7.28822 10.8453C7.09105 10.7196 6.9246 10.5513 6.80114 10.3528C6.67768 10.1542 6.60035 9.93047 6.57486 9.69805C6.54937 9.46563 6.57636 9.23045 6.65385 9.00985C6.73134 8.78925 6.85735 8.58886 7.0226 8.42344L7.03197 8.41406L10.1413 5.39063L9.99916 5.35156L6.37885 6.41016L4.41635 10.3352L7.90463 12.8852L12.2117 13.9617L14.2179 11.9531ZM18.014 8.95625L16.3562 5.63281L15.5328 6.04453L17.1945 9.36719L18.014 8.95625Z"
      fill="#455468"
    />
  </svg>
);

const HistoryIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M10.9375 6.25003V9.46956L13.607 11.0711C13.715 11.1332 13.8095 11.2162 13.885 11.3152C13.9605 11.4143 14.0155 11.5274 14.0469 11.6479C14.0782 11.7684 14.0852 11.894 14.0675 12.0173C14.0497 12.1405 14.0076 12.259 13.9436 12.3658C13.8795 12.4727 13.7948 12.5656 13.6945 12.6394C13.5941 12.7131 13.48 12.7661 13.3589 12.7952C13.2379 12.8243 13.1122 12.8291 12.9893 12.8091C12.8663 12.7892 12.7486 12.7449 12.643 12.6789L9.51797 10.8039C9.37909 10.7207 9.26414 10.6029 9.18432 10.462C9.1045 10.3211 9.06253 10.1619 9.0625 10V6.25003C9.0625 6.00139 9.16127 5.76293 9.33709 5.58711C9.5129 5.4113 9.75136 5.31253 10 5.31253C10.2486 5.31253 10.4871 5.4113 10.6629 5.58711C10.8387 5.76293 10.9375 6.00139 10.9375 6.25003ZM10 2.18753C8.97273 2.18488 7.95515 2.38612 7.00621 2.77959C6.05728 3.17306 5.19586 3.75092 4.47188 4.47971C4.10547 4.85003 3.76875 5.21174 3.4375 5.57346V5.00003C3.4375 4.75139 3.33873 4.51293 3.16291 4.33711C2.9871 4.1613 2.74864 4.06253 2.5 4.06253C2.25136 4.06253 2.0129 4.1613 1.83709 4.33711C1.66127 4.51293 1.5625 4.75139 1.5625 5.00003V8.12503C1.5625 8.37367 1.66127 8.61212 1.83709 8.78794C2.0129 8.96375 2.25136 9.06253 2.5 9.06253H5.625C5.87364 9.06253 6.1121 8.96375 6.28791 8.78794C6.46373 8.61212 6.5625 8.37367 6.5625 8.12503C6.5625 7.87639 6.46373 7.63793 6.28791 7.46211C6.1121 7.2863 5.87364 7.18753 5.625 7.18753H4.51328C4.92188 6.71878 5.34141 6.26721 5.80156 5.80159C6.62669 4.97623 7.67675 4.41233 8.82054 4.18038C9.96433 3.94842 11.1511 4.05869 12.2326 4.49741C13.3141 4.93612 14.2423 5.68383 14.9012 6.64708C15.5601 7.61034 15.9206 8.74642 15.9375 9.91337C15.9544 11.0803 15.627 12.2264 14.9963 13.2083C14.3656 14.1903 13.4594 14.9646 12.3911 15.4344C11.3228 15.9043 10.1397 16.0489 8.9897 15.8502C7.83967 15.6515 6.7737 15.1183 5.925 14.3172C5.74411 14.1465 5.50281 14.0546 5.25418 14.0618C5.00555 14.069 4.76995 14.1746 4.59922 14.3555C4.42849 14.5364 4.3366 14.7777 4.34378 15.0263C4.35096 15.2749 4.45661 15.5105 4.6375 15.6813C5.56486 16.5566 6.69242 17.1917 7.92171 17.531C9.151 17.8702 10.4447 17.9034 11.6897 17.6276C12.9348 17.3519 14.0934 16.7755 15.0645 15.9488C16.0355 15.1222 16.7894 14.0704 17.2604 12.8853C17.7314 11.7002 17.9051 10.4178 17.7663 9.15012C17.6276 7.88243 17.1807 6.66798 16.4645 5.61279C15.7484 4.55761 14.7848 3.69377 13.658 3.0967C12.5311 2.49964 11.2753 2.18749 10 2.18753Z"
      fill="#455468"
    />
  </svg>
);
